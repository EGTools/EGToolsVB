## EGToolsVB ##

ExcelDna를 이용하여 VB.NET으로 작성한 Excel 추가기능입니다.

구버전에서 새로 발표된 함수를 사용할 수 있도록 호환함수를 제공하며

다양한 기능과 전용 함수를 제공하고 있습니다.
​

# 리본메뉴 #

리본메뉴에서 지원하는 기능은 다른 모든 매크로처럼 되돌리기(Ctrl+Z)가 지원되지 않습니다.


[지원]항목은 Excel2007에서만 보임(2010이상의 오른쪽 마우스 메뉴 항목)

1.1. 복사 및 붙여넣기 : 보이는 셀만 복사하거나 보이는 셀에만 붙여넣기

1.2. 병합 및 분할 : 내용 그대로 셀을 병합하거나, 내용과 함께 병함된 셀을 분할

1.3. 사진/그림 관리 : 사진/그림을 삽입하거나, 셀에 맞추고, 일괄 추출하는 기능

1.4. 달력/일정표 : 연간 달력, 월 일정표, 주간 일정표, 일일 일정표 시트를 자동 생성

1.5. 양식 : 양식을 복제하거나, 목록으로 채워서 개별로 저장하는 기능

1.6. 도구

 - 스타일 삭제 : 불필요한 셀스타일 삭제

 - 이름 삭제 : 참조 오류인 이름을 삭제

 - 오류 정리 : 함수 오류를 보이지 않도록 IfError()함수를 자동으로 추가

 - 빈셀 정리 : 길이가 없는 문자열("")이 있는 셀을 실제 빈셀로 정리 

 - 메모 정돈 : 모든 메모를 작성된 셀 오른쪽 옆으로 이동

 - 테두리색 변경 : 선택영역에 설정된 테두리만 색을 일괄 변경

 - 모양 뽑기 : 바탕색을 이용하여 모양을 만들면, 그 테두리를 따서 자유도형을 생성

 - UDF 교정 : 다른 Excel 버전에서 작성된 EGToolsVB 호환함수와 내장함수의 자동 변경

 - CheckBox 적용 : 셀서식을 이용하여 CheckBox를 0과 1로 사용할 수 있도록 설정

1.7 ContextMenu (마우스 오른쪽 버튼 메뉴 -> Excel 2007은 "지원" 항목)

 - 날짜입력 : 공휴일이 표시된 달력을 이용하여 날짜를 선택 입력

 - 링크열기 : 셀 내용중 인터넷 URL이 있으면 HyperLink 설정이 없어도 해당 URL로 이동

​

​

# 함수 #

## Excel 신규 함수의 호환 함수 ##

### Microsoft 365 Excel 예정함수 ###

- 현재 없음

### Microsoft 365 Excel 신규함수 ###

- GROUPBY 함수 : 한 축을 따라 그룹화하고 연결된 값을 집계할 수 있습니다

- PIVOTBY 함수 : 두 축을 따라 그룹화하고 연결된 값을 집계할 수 있습니다

- PERCENTOF 함수 : 하위 집합이 지정된 데이터 집합을 구성하는 백분율을 반환합니다

- REGEXTEST 함수 : 텍스트 일부가 정규 표현식과 일치하는지 확인합니다

- REGEXEXTRACT 함수 : 정규 표현식에 따라 일치하는 하위 문자열을 추출합니다

- REGEXREPLACE 함수 : 정규 표현식을 사용하여 문자열의 일부를 다른 문자열로 바꿉니다

- TRIMRANGE 함수 : 지정된 범위나 배열의 빈 행/열을 제거합니다

​

### Excel 2024 신규함수 ###

- TEXTSPLIT 함수 : 열과 행 구분 기호를 사용하여 텍스트 문자열을 분할합니다

- TEXTAFTER 함수 : 지정된 문자 또는 문자열 뒤에 나타나는 텍스트를 반환합니다

- TEXTBEFORE 함수 : 지정된 문자 또는 문자열 앞에 나타나는 텍스트를 반환합니다

- VSTACK 함수 : 배열을 세로방향으로 순서대로 추가하여 더 큰 배열을 반환합니다

- HSTACK 함수 : 배열을 가로방향으로 순서대로 추가하여 더 큰 배열을 반환합니다

- TOCOL 함수 : 단일 열의 배열을 반환합니다

- TOROW 함수 : 단일 행의 배열을 반환합니다

- WRAPCOLS 함수 : 지정된 수의 요소 뒤에 있는 열별로 제공된 값 행 또는 열을 래핑하여 새 배열을 구성합니다

- WRAPROWS 함수 : 지정된 수의 요소 뒤에 있는 열별로 제공된 값 행 또는 열을 래핑하여 새 배열을 구성합니다

- CHOOSECOLS 함수 : 배열이나 범위에서 지정된 열 순서대로 재배열한 배열을 반환합니다

- CHOOSEROWS 함수 : 배열이나 범위에서 지정된 행 순서대로 재배열한 배열을 반환합니다

- TAKE 함수 : 배열의 시작 또는 끝에서 지정된 수의 연속 행 또는 열을 반환합니다

- DROP 함수 : 배열의 시작 또는 끝에서 지정된 수의 행 또는 열을 제외합니다

- EXPAND 함수 : 배열을 확장하거나 지정된 행 및 열 차원으로 채웁니다

- VALUETOTEXT 함수 : 텍스트 값을 변경하지 않고 전달하며 텍스트가 아닌 값을 텍스트로 변환합니다

- ARRAYTOTEXT 함수 : 배열내의 텍스트 값을 변경하지 않고 전달하며 텍스트가 아닌 값을 텍스트로 변환합니다

- IMAGE 함수 : 인터넷에 올려진 이미지 URL이나 컴퓨터에 저장된 파일명으로 이미지를 삽입합니다

​

### Excel 2021 신규함수 ###

- XMATCH 함수 : 배열 또는 셀 범위에서 지정된 항목을 검색한 다음 항목의 상대 위치를 반환합니다

- XLOOKUP 함수 : 테이블 또는 행별 범위에서 항목을 찾습니다

- XFILTER 함수 : 직접 정의한 조건을 바탕으로 일정 범위의 데이터를 필터링합니다

- XSORT 함수 : 범위 또는 배열의 내용을 정렬합니다

- SORTBY 함수 : 대응되는 범위 또는 배열의 값을 기준으로 범위 또는 배열의 내용을 정렬합니다

- UNIQUE 함수 : 목록 또는 범위에서 고유 값의 목록을 반환합니다

- SEQUENCE 함수 : 1, 2, 3, 4와 같이 일련의 연속된 숫자 목록을 생성합니다

- RANDARRAY 함수 : 임의의 숫자 배열을 생성합니다

- XLET 함수 : 계산 결과에 이름을 할당합니다. 중간 계산, 값을 저장하거나 이름을 정의할 수 있습니다

​

### Excel 2019 신규함수 ###

- IFS 함수 : 하나 이상의 조건이 충족되는지 확인하고 첫 번째 TRUE 조건에 해당하는 값을 반환합니다

- MINIFS 함수 : 하나 이상의 조건이 모두 충족되는 최소값을 반환합니다

- MAXIFS 함수 : 하나 이상의 조건이 모두 충족되는 최대값을 반환합니다

- CONCAT 함수 : 여러 범위 및/또는 문자열의 텍스트를 결합합니다

- TEXTJOIN 함수 : 여러 범위 및/또는 문자열의 텍스트를 결합하며 구분기호를 포함합니다.

- SWITCH 함수 : 하나의 수식 또는 값을 평가하고 첫 번째 일치하는 값에 해당하는 결과를 반환합니다

​

### Excel 2013 신규함수 ###

- ENCODEURL 함수 : 값을 브라우저에서 사용할 수 있도록 Encoding합니다

- IFNA 함수 : #N/A 오류일 때 지정한 값으로 변경합니다

- UNICHAR 함수 : 지정한 코드값의 유니코드 문자를 반환합니다

- UNICODE 함수 : 첫번째문자의 유니코드 코드값을 반환합니다

- FORMULATEXT 함수 : 지정한 셀에 입력된 함수를 보여줍니다

​

### 구버전을 위한 배열 함수​ (Excel 2019이하에서 Ctrl+Shift+Enter로 입력) ###

- xIf 함수 : If 함수를 범위로 작성하면 범위로 출력합니다.

- xIfError 함수 : IfError 함수를 배열이나 범위로 작성하면 범위로 출력합니다.

- ArrayFormula 함수 : 배열함수를 입력하면 범위로 출력합니다.

  함수명은 AF로도 사용 가능

​

## Google Sheets 전용함수의 호환 함수 ##

- GOOGLETRANSLATE 함수 : Google의 번역 서비스를 이용한 번역을 제공합니다

- IMPORTRANGE 함수 : Google Sheets의 지정하는 범위를 가져옵니다

- IMPORTHTML 함수 : 인터넷 페이지의 표나 목록을 지정하여 자료를 가져옵니다

- IMPORTFEED 함수 : RSS나 ATOM feed 정보를 가져옵니다

- IMPORTDATA 함수 : csv나 tsv 파일의 데이터를 읽어 옵니다

- QUERY 함수 : 데이터에서 ADODB에 사용하는 언어로 검색을 실행합니다.

​

## EGTools 전용 함수 ##

### 데이터 함수 ###

- COMPARELIST 함수 : 두개의 목록에 대해서 개별 값을 비교한 결과 목록을 나열합니다

- SHEETLIST 함수 : 현재 Workbook의 시트 목록을 나열합니다.

- ADVANCEDFILTER 함수 : 고급필터 결과를 나열합니다.

- BOMTREE 함수 : 모자구성된 BOM 목록을 다단계 BOM목록으로 재구성합니다.

- EXPLODE 함수 : 지정하는 열에 대해서 구분자를 기준으로 분해하여 나열​

- UNPIVOT 함수 : 피벗테이블이나 크로스탭을 일반 데이터 표로 변환합니다

- VISIBLEAGGR 함수 : 보이는 셀에 대해서만 지정한 함수 계산을 수행합니다

- ILOOKUP 함수 : (Image LookUp) XLOOKUP과 같은 방식으로 이미지를 가져옵니다.

​

### 문자열 함수 ###

- STREXT 함수 : 숫자, 영문, 영숫자, 한글, 일본어, 한자/중국어를 추출하거나 제거합니다

- TRIMENDS 함수 : 양쪽 끝의 공백만 제거합니다.

- TEXTNUMSORT 함수 : 문자와 숫자가 섞여 있는 데이터를 정렬할 때, 숫자가 숫자로 정렬하도록 합니다

- TEXTBETWEEN 함수 : 시작키와 끝키 사이의 문자열을 추출합니다.

- TEXTREPLACE 함수 : 시작키와 끝키 사이의 문자열을 대체합니다.

- JSONFILTER 함수 : JSON문자열을 파싱하여 출력합니다.

​

### 날짜시간 함수 ###

- TOLUNAR 함수 : 양력날짜를 음력날짜로 변환합니다

- TOSOLAR 함수 : 음력날짜를 양력날짜로 변환합니다

- KOREANHOLIDAYS 함수 : 대한민국의 공휴일을 나열하는 함수입니다

- NETWORKHOUR 함수 : 휴식시간을 제외한 순근무시간을 계산합니다.

​

### 색상 함수 ###

- DISPLAYCOLOR 함수 : 대상셀의 보이는 색으로 바탕색/글자색의 색번호를 반환합니다

- SUMIFCOLOR 함수 : 대상범위의 보이는 색이 기준셀과 같은 바탕색/글자색이면 숫자를 더합니다

- COUNTIFCOLOR 함수 : 대상범위의 보이는 색이 기준셀과 같은 바탕색/글자색이면 숫자를 셉니다

​

### 바코드 함수 ###

- BARCODE 함수 : 1D 및 2D 바코드 이미지를 생성합니다.

```
   바코드 유형 : QRCODE, CODE128, DATAMATRIX, PDF417, AZTEC, CODE39, CODE93 ,EAN8, EAN13, 
                ITF, CODABAR, UPC_A, UPC_E, UPC_EAN_EXTENSION, IMB, MSI, PHARMA_CODE, 
                RSS_14, RSS_EXPANDED
```

- QRCODE 함수 : QRCODE 바코드 이미지를 생성합니다 (GS1-QR 가능)

- CODE128 함수 : CODE128 바코드 이미지를 생성합니다 (GS1-128 가능)
 
- DATAMATRIX 함수 : DATAMATRIX 바코드 이미지를 생성합니다 (GS1-DM 가능)

​

### 품질 함수 ###

- SAMPLINGLABEL 함수 : ISO 2859-1에서 LOT크기와 검사수준에 따른 시료문자를 구합니다

- SAMPLINGSIZE 함수 : ​ISO 2859-1에 규정된 샘플링 방식에서 LOT크기와 AQL, 검사방법에 따라 검사할 시료수

- SAMPLINGAC 함수 : LOT크기와 AQL, 검사수준에 따라 검사할 합격판정 최대 불량수

- SAMPLINGRE 함수 : LOT크기와 AQL, 검사수준에 따라 검사할 불합격판정 최소 불량수

- CP 함수 : 측정치에 대해 계산한 공정능력(Cp)

- CPK 함수 : 측정치에 대해 계산한 공정능력지수(Cpk) 

​

### 공개API 함수 ###

- EXRATE 함수 : 외환 환율을 조회합니다

- SEARCHADDRESS 함수 : 도로명 주소 검색을 통하여 정보를 조회합니다

- BRNSTATUS 함수 : 국세청의 API를 이용하여 사업자등록번호의 현재 상태를 조회합니다

- RESTAPI 함수 : RESTful API 서비스를 이용한 결과를 반환합니다.

- GEOSEARCH 함수 : 주소 및 장소를 검색하여 GPS 좌표를 구합니다.

- GEOCODER 함수 : 주소에 해당하는 GPS 좌표를 구합니다.

- GEOADDRESS 함수 : 경위도나 x,y 좌표에 해당하는 주소를 구합니다.

- ADDRESSMAP 함수 : 주소에 해당하는 지적도를 다운로드 합니다.

​

### 기타 함수 ###

- EGTOOLSPATH 함수 : EGToolsVB가 설치된 폴더를 알려줍니다

- EVAL 함수 : 주어진 문자열의 Excel에서의 계산 결과를 산출합니다

- SHEETLIST 함수 : 시트목록을 출력합니다.

- DIRFOLDER 함수 : 지정한 폴더의 파일 목록을 출력합니다

- ISVISIBLE 함수 : 지정범위의 셀이 보이는 셀인지 확인합니다

​

## 신규 Excel 버전에서 동일 함수를 사용하는 방법 ##

  - Excel 신규 버전에서 이미 지원중인 함수에 대해서 EGToolsVB버전의 함수를 사용하려면

    본 함수명 앞에 "Eg"를 붙여서 등록해 두었으므로 아래름 참고하세요. 

 예)  Excel2021에서 지원하는 SORT 함수는 
     Excel 2019까지는 xSORT 함수로 사용할 수 있고,
     Excel 2021부터는 Eg.SORT 함수로 사용할 수 있습니다.

​

## VBA에서 EGTools Xll 함수를 사용하는 방법 ##

- Application.Run 방식으로 사용하세요.

- 함수명은 사용자별 버전에 맞게 등록된 이름을 사용해야 합니다. (대소문자는 상관 없습니다)

  예) EGTools의 SORTBY는 
    Excel 2019까지는 "SortBy"로, Excel 2021부터는 "Eg.SortBy"로 사용해야 합니다.

```
Sub EGXLL()
    '// Application.Run("Excel에 등록된 함수 이름", 인수1, 인수2, 인수3,,,)
    Dim result As Variant
    result = Application.Run("Eg.Sequence", 5, 5)  '//Excel 2019까지는 "Sequence"
    MsgBox Application.Sum(result)
End Sub
```

## 오류발생시 해결 방법 ##

- 기능 사용중 오류 발생시 사용중인 파일을 저장하고 Excel을 다시 시작해 보세요.

- 함수 사용중 오류는 함수 설명서를 참고하시고, 설명에 없는 오류는 알려주시면 수정하겠습니다.

​

## EGToolsVB 추가기능 사용중단 및 삭제 제거 ##

EGToolsVB 추가기능을 사용중지할 때에는 Excel추가기능에서 EGToolsVB 항목을 선택해제하세요.

파일을 먼저 삭제하면 Excel 시작시 파일을 찾을 수 없다는 경고가 나옵니다.

​

## 감사 인사 ##

기능에 대한 조언과 테스트를 통해 오류를 잡아 주시는 분들께 항상 감사 드립니다.

​

## 사용 권한 ##

EGToolsVB 추가기능은 개인, 회사, 관공서 등 누구나 무료로 사용할 수 있습니다.

EGToolsVB에서는 기능 최적화를 위하여 OS버전, Excel버전 등의 정보를 수집하고 있습니다.

EGToolsVB 추가기능을 사용함으로써 발생하는 모든 책임은 사용자에게 있으며

사용중 발생한 어떠한 피해에 대해서도 개발자/배포자에게 책임을 청구할 수 없습니다.

​

만약 상기 내용에 동의하지 않는다면, EGTools 추가기능의 사용을 중단하고 파일을 삭제 바랍니다.
